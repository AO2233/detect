from VideoPose3D.common.camera import *

custom_camera_params = {
    'id': None,
    'res_w': None,  # Pulled from metadata
    'res_h': None,  # Pulled from metadata

    # Dummy camera parameters (taken from Human3.6M), only for visualization purposes
    'azimuth': 70,  # Only used for visualization
    'orientation': [0.1407056450843811, -0.1500701755285263, -0.755240797996521, 0.6223280429840088],
    'translation': [1841.1070556640625, 4955.28466796875, 1563.4454345703125],
}

"""
debug
rot [0.14070565 -0.15007018 -0.7552408   0.62232804]
t 0
"""
# return qrot(np.tile(R, (*X.shape[:-1], 1)), X)
# def camera_to_world(X, R, t):
#     return wrap(qrot, np.tile(R, (*X.shape[:-1], 1)), X) + t

prediction = camera_to_world(prediction, R=rot, t=0)
# We don't have the trajectory, but at least we can rebase the height
prediction[:, :, 2] -= np.min(prediction[:, :, 2])


"""
before
0.00004,0.00056,0.00013
0.02210,0.01849,-0.07802
0.07122,0.36721,0.06731
0.04237,0.59859,0.20837
-0.02210,-0.01849,0.07802
0.03484,0.19196,0.22832
-0.02755,0.43275,0.43176
0.10708,-0.27668,-0.03371
0.15144,-0.40870,-0.09528
0.26356,-0.50662,-0.13858
0.28584,-0.56637,-0.19820
0.15710,-0.35835,-0.00335
0.22758,-0.14261,0.07784
0.22145,-0.08133,0.09832
0.17438,-0.37284,-0.15945
0.18634,-0.33523,-0.09797
0.21285,-0.23415,-0.02686


after
-0.00006,0.00000,-0.00057
0.01188,0.08226,-0.00310
-0.07314,0.03443,-0.37137
-0.09114,-0.06208,-0.62559
-0.01188,-0.08226,0.00310
-0.11316,-0.15636,-0.23008
-0.12489,-0.32064,-0.50600
-0.09882,0.02338,0.28079
-0.12164,0.07267,0.42305
-0.21203,0.13894,0.53016
-0.21169,0.19064,0.60050
-0.16094,0.00150,0.35665
-0.24675,-0.00416,0.13148
-0.24616,-0.01395,0.06732
-0.11517,0.14597,0.40034
-0.14872,0.10237,0.35228
-0.19618,0.06741,0.24047


fin
-0.00006,0.00000,0.70297
0.01188,0.08226,0.70044
-0.07314,0.03443,0.33217
-0.09114,-0.06208,0.07795
-0.01188,-0.08226,0.70664
-0.11316,-0.15636,0.47346
-0.12489,-0.32064,0.19753
-0.09882,0.02338,0.98433
-0.12164,0.07267,1.12659
-0.21203,0.13894,1.23370
-0.21169,0.19064,1.30404
-0.16094,0.00150,1.06019
-0.24675,-0.00416,0.83501
-0.24616,-0.01395,0.77085
-0.11517,0.14597,1.10387
-0.14872,0.10237,1.05582
-0.19618,0.06741,0.94401
"""